-- INFO - 18:39:09--03-15-2025:
-- -- LOG STARTED ======================================================

-- DEBUG - 18:39:09--03-15-2025:
-- -- Starting new HTTPS connection (1): stats.nba.com:443

-- DEBUG - 18:39:10--03-15-2025:
-- -- https://stats.nba.com:443 "GET /stats/leaguegamefinder?Conference=&DateFrom=12%2F14%2F2024&DateTo=12%2F14%2F2024&Division=&DraftNumber=&DraftRound=&DraftTeamID=&DraftYear=&EqAST=&EqBLK=&EqDD=&EqDREB=&EqFG3A=&EqFG3M=&EqFG3_PCT=&EqFGA=&EqFGM=&EqFG_PCT=&EqFTA=&EqFTM=&EqFT_PCT=&EqMINUTES=&EqOREB=&EqPF=&EqPTS=&EqREB=&EqSTL=&EqTD=&EqTOV=&GameID=&GtAST=&GtBLK=&GtDD=&GtDREB=&GtFG3A=&GtFG3M=&GtFG3_PCT=&GtFGA=&GtFGM=&GtFG_PCT=&GtFTA=&GtFTM=&GtFT_PCT=&GtMINUTES=&GtOREB=&GtPF=&GtPTS=&GtREB=&GtSTL=&GtTD=&GtTOV=&LeagueID=00&Location=&LtAST=&LtBLK=&LtDD=&LtDREB=&LtFG3A=&LtFG3M=&LtFG3_PCT=&LtFGA=&LtFGM=&LtFG_PCT=&LtFTA=&LtFTM=&LtFT_PCT=&LtMINUTES=&LtOREB=&LtPF=&LtPTS=&LtREB=&LtSTL=&LtTD=&LtTOV=&Outcome=&PORound=&PlayerID=&PlayerOrTeam=P&RookieYear=&Season=&SeasonSegment=&SeasonType=&StarterBench=&TeamID=&VsConference=&VsDivision=&VsTeamID=&YearsExperience= HTTP/1.1" 200 2192

-- INFO - 18:39:10--03-15-2025:
-- -- Fetched 37 game logs from 12/14/2024

-- INFO - 18:39:10--03-15-2025:
-- -- Cleaning and transforming 37 game logs for insert

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into active_players (player_id, player_name, team_id) values (%s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D7750>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in active_players before insert: 629

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Duplicate entry '203114-1610612749' for key 'PRIMARY'
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into active_teams (team_id, team, team_name) values (%s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D6AD0>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in active_teams before insert: 30

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Duplicate entry '1610612749' for key 'PRIMARY'
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into game (game_id, season_id, game_date, matchup, game_type, ot_ind, final_score) values (%s, %s, %s, %s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D79D0>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in game before insert: 991

-- INFO - 18:39:10--03-15-2025:
-- -- Insert function executed successfully, but no new records were inserted into game

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into player_box (game_id, player_id, team_id, mins, pts, ast, reb, stl, blk, oreb, dreb, tov, pf) values (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D7890>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in player_box before insert: 21244

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Cannot add or update a child row: a foreign key constraint fails (`nba_current`.`player_box`, CONSTRAINT `player_box_ibfk_1` FOREIGN KEY (`game_id`) REFERENCES `game` (`game_id`))
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into player_shooting (game_id, player_id, team_id, fgm, fga, fg3m, fg3a, ftm, fta, fg_pct, fg3_pct, ft_pct) values (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D7C50>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in player_shooting before insert: 21244

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Cannot add or update a child row: a foreign key constraint fails (`nba_current`.`player_shooting`, CONSTRAINT `player_shooting_ibfk_1` FOREIGN KEY (`game_id`) REFERENCES `game` (`game_id`))
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into team_box (game_id, team_id, mins, pts, ast, reb, stl, blk, oreb, dreb, tov, pf) values (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F5D7ED0>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in team_box before insert: 1982

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.DataError: Out of range value for column 'mins' at row 1
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into team_shooting (game_id, team_id, fgm, fga, fg3m, fg3a, ftm, fta, fg_pct, fg3_pct, ft_pct) values (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F6A4190>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in team_shooting before insert: 1994

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Duplicate entry '22401229-1610612737' for key 'PRIMARY'
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- DEBUG - 18:39:10--03-15-2025:
-- -- Insert statement generated: insert into team_gamelog (game_id, team_id, win_ind, home_ind) values (%s, %s, %s, %s);

-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection successful: <mariadb.connection connected to 'pi-jdeto' at 000002703F6A4410>

-- DEBUG - 18:39:10--03-15-2025:
-- -- Records in team_gamelog before insert: 1982

-- ERROR - 18:39:10--03-15-2025:
-- -- Could not insert records:
Traceback (most recent call last):
  File "D:\programming_projects\nba_etl\src\database\dml.py", line 20, in insert_into
    cur.execute(insert_query, value)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "d:\programming_projects\nba_etl\.venv\Lib\site-packages\mariadb\cursors.py", line 313, in execute
    self._execute_binary()
    ~~~~~~~~~~~~~~~~~~~~^^
mariadb.IntegrityError: Cannot add or update a child row: a foreign key constraint fails (`nba_current`.`team_gamelog`, CONSTRAINT `team_gamelog_ibfk_1` FOREIGN KEY (`game_id`) REFERENCES `game` (`game_id`))
-- DEBUG - 18:39:10--03-15-2025:
-- -- Database connection closed

-- INFO - 18:39:10--03-15-2025:
-- -- ETL complete for 12/14/2024

-- DEBUG - 18:39:10--03-15-2025:
-- -- Delaying for 60 seconds...

-- INFO - 18:39:10--03-15-2025:
-- -- LOG COMPLETE =======================================================

